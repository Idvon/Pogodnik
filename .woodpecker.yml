variables:
  - &pogodnik_image git.wearentsa.me/dd/pogodnik:ci

pipeline:

  publish:
    image: woodpeckerci/plugin-docker-buildx
    settings:
      repo: git.wearentsa.me/dd/pogodnik
      tag: ci
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password

  black:
    group: linters
    image: *pogodnik_image
    commands:
      - poetry run black --check .

  isort:
    group: linters
    image: *pogodnik_image
    commands:
      - poetry run isort --check .

  mypy:
    group: linters
    image: *pogodnik_image
    commands:
      - poetry run mypy PoGoDnIk.py src/
